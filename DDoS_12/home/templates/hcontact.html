{% extends 'index.html' %}
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>Contactus</title>      
</head>
<body>

{% block loader %}{% endblock %}

{% block content %}

<style>
  .fade-in {
    opacity: 0;
    transform: translateY(20px);
    animation: fadeInMoveUp 0.6s ease-out forwards;
    position: relative;
  }

  @keyframes fadeInMoveUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  #location-info {
    position: absolute;
    top: 50px;
    left: 380px; /* <-- increase this value to move leftward */
    width: 250px;
    min-height: 120px;
    white-space: pre-line;
    font-size: 0.95rem;
    font-family: monospace;
    color: white;
    z-index: 10;
  }

  #cursor {
    animation: blink 0.8s infinite;
  }

  @keyframes blink {
    0%, 50%, 100% { opacity: 1; }
    25%, 75% { opacity: 0; }
  }

  @media (max-width: 768px) {
    #location-info {
      position: static !important;
      margin-top: 2rem;
      margin-left: 0;
      width: 100%;
      text-align: left;
    }
    .fade-in {
      flex-direction: column !important;
      align-items: flex-start !important;
      width: 300px;
    }
  }

</style>

<div class="fade-in">
  <h1 class="fst-italic lh-1 mb-4">Contact Us</h1>

  <form action="hcontact" method="post">
    {% csrf_token %}
    <div class="row input-group-newsletter">
      <div class="col">

        <!-- Full Name -->
        <div class="mb-3">
          <input class="form-control" id="name" name="cname" type="text" placeholder="Enter Your Name" required />
        </div>

        <!-- Email -->
        <div class="mb-3">
          <input class="form-control" id="email" name="cemail" type="email" placeholder="Enter Your Email" required />
        </div>

        <!-- Phone -->
        <div class="mb-3">
          <input class="form-control" id="phone" name="cnumber" type="tel" placeholder="Enter Your Phone Number" required />
        </div>

        <!-- Message -->
        <div class="mb-4">
          <textarea class="form-control" id="message" name="cmsg" rows="4" placeholder="Enter Your Message" required></textarea>
        </div>

        <!-- Submit Button -->
        <div class="d-grid">
          <input type="submit" class="btn btn-primary" id="submitMessage" value="Send Message">
        </div>

        <!-- Error Feedback -->
        <div class="invalid-feedback mt-2" id="formError" style="display: none;">Please fill in all fields correctly.</div>

        <!-- Already have account -->
        <h6 class="text-center mt-3">
          Want to move back ?
          <a class="text-primary" href="{% url 'home' %}">Login</a>
        </h6>
      </div>
    </div>
  </form>
  <!-- Location Info Typing Box absolutely positioned -->
  <div id="location-info">
    <span id="typed-text"></span><span id="cursor">|</span>
  </div>

</div>

{% if messages and contact_page %}
  <div id="custom-tooltip" style="
    position: fixed;
    top: 20px;
    left: 65%;
    background: #333;
    color: #fff;
    padding: 6px 12px;
    border-radius: 6px;
    font-size: 14px;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s;
    z-index: 9999;
  ">
    {% for message in messages %}
      {{ message }}
    {% endfor %}
  </div>

  <script>
    const tooltip = document.getElementById('custom-tooltip');
    tooltip.style.opacity = '1';
    tooltip.style.pointerEvents = 'auto';

    setTimeout(() => {
      tooltip.style.opacity = '0';
      tooltip.style.pointerEvents = 'none';
    }, 4000);
  </script>
{% endif %}

<!-- Bootstrap core JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- Core theme JS -->
<script src="{% static 'js/scripts.js' %}"></script>

<!-- SB Forms JS -->
<script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>

<script>
  const contactBtn = document.getElementById("submitMessage");
  const nameInput = document.getElementById("name");
  const emailInput = document.getElementById("email");
  const phoneInput = document.getElementById("phone");
  const messageInput = document.getElementById("message");
  const formError = document.getElementById("formError");

  function validateContactForm() {
    const validEmail = emailInput.value.includes("@");
    const allFilled =
      nameInput.value.trim() &&
      emailInput.value.trim() &&
      phoneInput.value.trim() &&
      messageInput.value.trim();

    formError.style.display = validEmail ? "none" : "block";
    contactBtn.disabled = !(validEmail && allFilled);
  }

  [nameInput, emailInput, phoneInput, messageInput].forEach((input) => {
    input.addEventListener("input", validateContactForm);
  });

  // Typing animation for location info
  const locationText = `Feel free to reach out using the form to share your message or ask us anything.\nWe're happy to hear from you and will get back as soon as we can.\n\n**Location**\nABCD,\nState,\nCountry\n\n**Contact**\n+Code 01823397432991`;
  const typedTextEl = document.getElementById("typed-text");
  const cursorEl = document.getElementById("cursor");

  function typeLocationText(text, delay = 80) {
    let i = 0;
    let inBold = false;

    typedTextEl.innerHTML = '';

    function typeNext() {
      if (i >= text.length) return;

      if (text[i] === '*' && text[i + 1] === '*') {
        inBold = !inBold;
        i += 2;
        typeNext();
        return;
      }

      const span = document.createElement(inBold ? 'strong' : 'span');
      if (text[i] === '\n') {
        typedTextEl.appendChild(document.createElement('br'));
      } else {
        span.textContent = text[i];
        typedTextEl.appendChild(span);
      }

      i++;
      setTimeout(typeNext, delay);
    }

    typeNext();
  }

  // Initially disable the button
  // contactBtn.disabled = true;

  // document.getElementById("ContactForm").addEventListener("submit", (e) => {
  //   e.preventDefault();
  //   if (!contactBtn.disabled) {
  //     console.log("Contact Message Submitted:", {
  //       name: nameInput.value,
  //       email: emailInput.value,
  //       phone: phoneInput.value,
  //       message: messageInput.value,
  //     });

  //     // Optional: clear form after submission
  //     document.getElementById("ContactForm").reset();
  //     contactBtn.disabled = true;
  //   }
  // });

  window.addEventListener("DOMContentLoaded", () => {
    typeLocationText(locationText);
  });

  // Fade-in animation
  window.addEventListener("DOMContentLoaded", () => {
    const content = document.querySelector(".fade-in");
    if (content) {
      setTimeout(() => {
        content.classList.add("fade-in");
      }, 600);
    }
  });
</script>

{% endblock %}

</body>
</html>
